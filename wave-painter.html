<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Wave Painter | Mindful Haven</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link
        href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;800&family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap"
        rel="stylesheet">
  <link href="mobile-responsive.css" rel="stylesheet">
    <style>
        :root {
            /* Light Mode */
            --sage-gradient: linear-gradient(135deg, #c9dcc4 0%, #d4c5e8 100%);
            --sage-dark: #5a6b56;
            --sage-light: #e8f3e5;
            --lavender: #d4c5e8;
            --bg-primary: #f9fafb;
            --bg-secondary: #ffffff;
            --text-dark: #111827;
            --text-muted: #6b7280;
            --accent: #6366f1;
            --accent-soft: #eef2ff;
            --border-light: #e5e7eb;
            --glass-bg: rgba(255, 255, 255, 0.9);
        }

        [data-theme="dark"] {
            /* Dark Mode */
            --sage-gradient: linear-gradient(135deg, #1a1d2e 0%, #1f2937 100%);
            --sage-dark: #94a3b8;
            --sage-light: #1e293b;
            --lavender: #6366f1;
            --bg-primary: #0f1419;
            --bg-secondary: #1a1d2e;
            --text-dark: #f1f5f9;
            --text-muted: #94a3b8;
            --accent: #8b5cf6;
            --accent-soft: #312e81;
            --border-light: #2d3748;
            --glass-bg: rgba(26, 29, 46, 0.9);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: var(--bg-primary);
            color: var(--text-dark);
            font-family: 'Plus Jakarta Sans', sans-serif;
            min-height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            transition: background 0.3s;
        }

        .header-bar {
            width: 100%;
            padding: 20px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--glass-bg);
            backdrop-filter: blur(12px);
            border-bottom: 1px solid var(--border-light);
            z-index: 100;
        }

        .back-link {
            color: var(--text-dark);
            text-decoration: none;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 16px;
            border-radius: 20px;
            background: rgba(255, 255, 255, 0.1);
            transition: 0.3s;
        }

        .back-link:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateX(-5px);
        }

        .game-container {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            position: relative;
        }

        .canvas-wrapper {
            position: relative;
            border-radius: 24px;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
            border: 2px solid var(--border-light);
        }

        #waveCanvas {
            display: block;
            cursor: crosshair;
            background: var(--bg-secondary);
            transition: background 0.3s;
        }

        .controls {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 12px;
            background: var(--glass-bg);
            backdrop-filter: blur(16px);
            padding: 12px 20px;
            border-radius: 60px;
            border: 1px solid var(--border-light);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            flex-wrap: wrap;
            justify-content: center;
            max-width: 90%;
        }

        .control-group {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .btn {
            background: transparent;
            border: none;
            color: var(--text-dark);
            padding: 10px 18px;
            border-radius: 50px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.9rem;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        .btn.active {
            background: var(--accent);
            color: white;
        }

        .color-picker {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 3px solid var(--border-light);
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .color-picker:hover {
            transform: scale(1.1);
        }

        .color-picker.active {
            border-color: var(--accent);
            box-shadow: 0 0 0 3px var(--accent-soft);
        }

        .divider {
            width: 1px;
            height: 30px;
            background: var(--border-light);
            margin: 0 8px;
        }

        .info-panel {
            position: absolute;
            top: 100px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--glass-bg);
            backdrop-filter: blur(16px);
            padding: 16px 32px;
            border-radius: 50px;
            border: 1px solid var(--border-light);
            text-align: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .info-text {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-dark);
            opacity: 0.8;
        }

        @media (max-width: 768px) {
            .controls {
                padding: 10px 16px;
                gap: 8px;
            }

            .btn {
                padding: 8px 14px;
                font-size: 0.85rem;
            }

            .color-picker {
                width: 35px;
                height: 35px;
            }
        }
    </style>
</head>

<body>

    <div class="header-bar">
        <a href="games.html" class="back-link"><i class="fas fa-arrow-left"></i> Back to Games</a>
        <div style="font-weight: 700; font-size: 1.1rem;">Wave Painter</div>
    </div>

    <div class="info-panel">
        <div class="info-text">ðŸŒŠ Paint flowing waves with your cursor</div>
    </div>

    <div class="game-container">
        <div class="canvas-wrapper">
            <canvas id="waveCanvas"></canvas>
        </div>
    </div>

    <div class="controls">
        <div class="control-group">
            <div class="color-picker active" style="background: linear-gradient(135deg, #6366f1, #8b5cf6);"
                onclick="setColor('purple')" data-color="purple"></div>
            <div class="color-picker" style="background: linear-gradient(135deg, #3b82f6, #06b6d4);"
                onclick="setColor('blue')" data-color="blue"></div>
            <div class="color-picker" style="background: linear-gradient(135deg, #10b981, #34d399);"
                onclick="setColor('green')" data-color="green"></div>
            <div class="color-picker" style="background: linear-gradient(135deg, #f59e0b, #fbbf24);"
                onclick="setColor('yellow')" data-color="yellow"></div>
            <div class="color-picker" style="background: linear-gradient(135deg, #ec4899, #f472b6);"
                onclick="setColor('pink')" data-color="pink"></div>
            <div class="color-picker" style="background: linear-gradient(135deg, #c9dcc4, #d4c5e8);"
                onclick="setColor('sage')" data-color="sage"></div>
        </div>

        <div class="divider"></div>

        <div class="control-group">
            <button class="btn active" onclick="setMode('calm')" id="btn-calm">
                <i class="fas fa-water"></i> Calm
            </button>
            <button class="btn" onclick="setMode('flow')" id="btn-flow">
                <i class="fas fa-wind"></i> Flow
            </button>
            <button class="btn" onclick="setMode('energy')" id="btn-energy">
                <i class="fas fa-bolt"></i> Energy
            </button>
        </div>

        <div class="divider"></div>

        <button class="btn" onclick="clearCanvas()">
            <i class="fas fa-redo"></i> Clear
        </button>
    </div>

    <script>
        // Theme
        const savedTheme = localStorage.getItem('mh_theme') || 'light';
        document.documentElement.setAttribute('data-theme', savedTheme);

        const canvas = document.getElementById('waveCanvas');
        const ctx = canvas.getContext('2d');

        // Set canvas size
        function resizeCanvas() {
            const container = document.querySelector('.game-container');
            const maxWidth = Math.min(window.innerWidth - 80, 1000);
            const maxHeight = window.innerHeight - 250;
            canvas.width = maxWidth;
            canvas.height = maxHeight;
        }
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);

        // State
        let isDrawing = false;
        let points = [];
        let currentColor = 'purple';
        let currentMode = 'calm';

        // Color palettes
        const colors = {
            purple: ['#6366f1', '#8b5cf6', '#a78bfa', '#c4b5fd'],
            blue: ['#3b82f6', '#06b6d4', '#0ea5e9', '#38bdf8'],
            green: ['#10b981', '#34d399', '#6ee7b7', '#a7f3d0'],
            yellow: ['#f59e0b', '#fbbf24', '#fcd34d', '#fde68a'],
            pink: ['#ec4899', '#f472b6', '#fb7185', '#fda4af'],
            sage: ['#87a383', '#c9dcc4', '#d4c5e8', '#e8f3e5']
        };

        // Wave modes
        const modes = {
            calm: { amplitude: 15, frequency: 0.02, speed: 0.5, waves: 3 },
            flow: { amplitude: 25, frequency: 0.03, speed: 1, waves: 5 },
            energy: { amplitude: 40, frequency: 0.05, speed: 2, waves: 7 }
        };

        let time = 0;

        function setColor(color) {
            currentColor = color;
            document.querySelectorAll('.color-picker').forEach(el => {
                el.classList.toggle('active', el.dataset.color === color);
            });
        }

        function setMode(mode) {
            currentMode = mode;
            document.querySelectorAll('.btn').forEach(btn => {
                if (btn.id && btn.id.startsWith('btn-')) {
                    btn.classList.remove('active');
                }
            });
            document.getElementById(`btn-${mode}`).classList.add('active');
        }

        function clearCanvas() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            points = [];
        }

        // Drawing
        canvas.addEventListener('mousedown', startDrawing);
        canvas.addEventListener('mousemove', draw);
        canvas.addEventListener('mouseup', stopDrawing);
        canvas.addEventListener('mouseleave', stopDrawing);

        // Touch support
        canvas.addEventListener('touchstart', (e) => {
            e.preventDefault();
            const touch = e.touches[0];
            const rect = canvas.getBoundingClientRect();
            const x = touch.clientX - rect.left;
            const y = touch.clientY - rect.top;
            startDrawing({ offsetX: x, offsetY: y });
        });

        canvas.addEventListener('touchmove', (e) => {
            e.preventDefault();
            const touch = e.touches[0];
            const rect = canvas.getBoundingClientRect();
            const x = touch.clientX - rect.left;
            const y = touch.clientY - rect.top;
            draw({ offsetX: x, offsetY: y });
        });

        canvas.addEventListener('touchend', (e) => {
            e.preventDefault();
            stopDrawing();
        });

        function startDrawing(e) {
            isDrawing = true;
            points = [{ x: e.offsetX, y: e.offsetY }];
        }

        function draw(e) {
            if (!isDrawing) return;

            points.push({ x: e.offsetX, y: e.offsetY });

            // Keep only recent points for performance
            if (points.length > 100) {
                points.shift();
            }

            drawWaves();
        }

        function stopDrawing() {
            isDrawing = false;
        }

        function drawWaves() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            if (points.length < 2) return;

            const config = modes[currentMode];
            const palette = colors[currentColor];

            // Draw multiple wave layers
            for (let layer = 0; layer < config.waves; layer++) {
                ctx.beginPath();
                ctx.strokeStyle = palette[layer % palette.length];
                ctx.lineWidth = 3 - (layer * 0.3);
                ctx.lineCap = 'round';
                ctx.lineJoin = 'round';

                const offset = layer * 10;
                const phaseShift = layer * Math.PI / 4;

                for (let i = 0; i < points.length; i++) {
                    const point = points[i];
                    const wave = Math.sin((i * config.frequency) + time + phaseShift) * config.amplitude;

                    const x = point.x;
                    const y = point.y + wave + offset;

                    if (i === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        // Smooth curve
                        const prevPoint = points[i - 1];
                        const prevWave = Math.sin(((i - 1) * config.frequency) + time + phaseShift) * config.amplitude;
                        const prevX = prevPoint.x;
                        const prevY = prevPoint.y + prevWave + offset;

                        const cpX = (prevX + x) / 2;
                        const cpY = (prevY + y) / 2;

                        ctx.quadraticCurveTo(prevX, prevY, cpX, cpY);
                    }
                }

                ctx.globalAlpha = 0.6 - (layer * 0.08);
                ctx.stroke();
                ctx.globalAlpha = 1;
            }
        }

        // Animation loop
        function animate() {
            time += modes[currentMode].speed * 0.05;

            if (isDrawing || points.length > 0) {
                drawWaves();
            }

            requestAnimationFrame(animate);
        }

        animate();
    </script>
</body>

</html>